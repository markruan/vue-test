{"remainingRequest":"/Users/mc/项目/VUE/2020/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mc/项目/VUE/2020/node_modules/vue-audio-cover-x/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mc/项目/VUE/2020/node_modules/vue-audio-cover-x/index.vue","mtime":499162500000},{"path":"/Users/mc/项目/VUE/2020/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mc/项目/VUE/2020/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/mc/项目/VUE/2020/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mc/项目/VUE/2020/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n    name: '',\n    props: {\n        musicData:{\n            type: Object,\n            required: true,\n            default: {\n                title: \"起风了\",\n                cover: \"http://wenba-ooo-qiniu.xueba100.com/cd4ba4a4d6cc0925a9b39d65c3d11ad6.jpeg\",\n                src: \"http://ting666.yymp3.com:86/new27/mljyyj/1.mp3\",\n                audioDuration: '',\n                id: 0\n            }\n        }\n    },\n    data () {\n        return {\n            playStatus: false,\n            progress: 0, // 播放进度 0 － 100\n            duration: 0, // 总时长（秒）\n            durationTime: null, // 总时长（秒）\n            playStatusTime: 0, // 当前播放时间（秒）\n            playEnd: false, // 播放是否结束状态\n            loadingStatus: true\n        }\n    },\n    computed: {\n        progressStr (){\n            return (parseInt(this.progress)) + '%';\n        }\n    },\n    mounted (){\n        this.judegPlayStatusFn();\n        this.getDurationFn();\n        this.observerProgressFn();\n    },\n    methods: {\n        // 重置\n        reset() {\n            this.playStatus = false;\n            this.progress = 0;\n            this.duration = 0;\n            this.playStatusTime = 0;\n            this.loadingStatus = false;\n        },\n        // 播放切换\n        togglePlayFn (){\n            this.playStatus = !this.playStatus;\n            if (this.playStatus) {\n                // play\n                this.loadingStatus = true;\n                if (this.playEnd) {\n                    this.$refs.audioDom.currentTime = 0;\n                    this.observerProgressFn();\n                }\n                this.$refs.audioDom.play();\n            } else {\n                // pause\n                this.$refs.audioDom.pause();\n            }\n        },\n        // 点击\n        clickProgressFn (event){\n            var offsetX = event.offsetX;\n            var progerssWidth = this.$refs.progerssDom.offsetWidth;\n            this.calculationFn(offsetX, progerssWidth);\n            // 快进\n            if (this.durationTime !== null) {\n                this.$refs.audioDom.currentTime = offsetX / progerssWidth * this.durationTime;\n            }\n        },\n        // 拖动\n        moveProgressFn (event){\n            var progerssLeft = this.$refs.progerssDom.offsetLeft;\n            var progerssWidth = this.$refs.progerssDom.offsetWidth;\n            var maxClientX = progerssLeft + progerssWidth;\n            var clientX = event.touches[0].clientX;\n            if (event.touches[0].clientX >= maxClientX) {\n                clientX = maxClientX;\n            }\n            if (event.touches[0].clientX <= progerssLeft) {\n                clientX = progerssLeft;\n            }\n            var curLen = clientX - progerssLeft;\n            if (clientX > maxClientX) {\n                return false;\n            }\n            this.calculationFn(curLen, progerssWidth);\n            // 快进\n            if (this.durationTime !== null) {\n                this.$refs.audioDom.currentTime = curLen / progerssWidth * this.durationTime;\n            }\n        },\n        // 计算进度条\n        calculationFn (curLen, totalLen){\n            // curlen 当前长度；totleLen 总长\n            this.progress = (parseFloat(parseInt(curLen) / parseInt(totalLen))).toFixed(2) * 100;\n            this.progress = this.progress >= 100 ? 100 : this.progress;\n        },\n        // 获取时长\n        getDurationFn (){\n            var _this = this;\n            var audioDom = this.$refs.audioDom;\n            this.timer1 = setInterval(function () {\n                if (audioDom.readyState != 0) {\n                    _this.loadingStatus = false;\n                    _this.durationTime = audioDom.duration;\n                    _this.duration = audioDom.duration;\n                    clearInterval(_this.timer1);\n                }\n            }, 200);\n        },\n        // 监控播放进度\n        observerProgressFn (){\n            var _this = this;\n            var musicId = this.musicData.id || 0;\n            var audioDom = this.$refs.audioDom;\n            var audioDuration = null;\n            var isIOS = !!navigator.userAgent.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/);\n            if (isIOS) {\n                _this.loadingStatus = false;\n            }\n            this.timer2 = setInterval(function () {\n                if (audioDom.readyState === 4) {\n                    _this.loadingStatus = false;\n                    if (audioDuration === null) {\n                        audioDuration = audioDom.duration;\n                        _this.durationTime = audioDom.duration;\n                        _this.duration = audioDom.duration;\n                    }\n                    _this.playStatusTime = audioDom.currentTime;\n                    _this.progress = parseInt(audioDom.currentTime / audioDuration * 100);\n                    localStorage.setItem('musicId', musicId);\n                    localStorage.setItem('currentTime', audioDom.currentTime);\n                    if (audioDom.ended) {\n                        _this.playStatus = false;\n                        _this.playEnd = true;\n                        _this.playEndFn();\n                        clearInterval(_this.timer2);\n                    }\n                }\n            }, 1000)\n        },\n        // 监控音频播放结束\n        playEndFn () {\n            this.$emit('playEndFn');\n        },\n        // 判断是否有记忆播放状态\n        judegPlayStatusFn (){\n            if (this.musicData.hasOwnProperty('id') && this.musicData.id !== '' ) {\n                var musicId = localStorage.getItem('musicId');\n                var cookieCurrentTime = localStorage.getItem('currentTime');\n                if (musicId !== null && musicId == this.musicData.id) {\n                    this.$refs.audioDom.currentTime = cookieCurrentTime;\n                }\n            }\n        }\n    },\n    filters: {\n        // 秒(s) ＝> 00:00\n        changeTimeFn (time){\n            var timeRxFn = function (x) {\n                var timeRx = new RegExp(/^[0-9]$/g);\n                if (timeRx.test(x)) {\n                    return '0' + x;\n                } else {\n                    return x;\n                }\n            };\n            var _time = time;\n            var hour = parseInt(_time / 3600); //时\n            var minutes = parseInt((_time % 3600) / 60); //分\n            var second = parseInt((_time % 3600) % 60); //秒\n            var timeStr = hour + ':' + timeRxFn(minutes) + ':' + timeRxFn(second);\n            if (hour == 0) {\n                timeStr = timeRxFn(minutes) + ':' + timeRxFn(second);\n            }\n            return timeStr;\n        }\n    },\n    watch: {\n        'musicData.src': {\n            handler (newVal, oldVal){\n                this.reset();\n            },\n            deep: true\n        }\n    },\n    destroyed () {\n        clearInterval(this.timer1);\n        clearInterval(this.timer2);\n    }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/vue-audio-cover-x","sourcesContent":["<template>\n    <div class=\"audioPlayerX\">\n        <div class=\"audioCard\">\n            <button class=\"playBtn\" :style=\"'backgroundImage: url( ' + musicData.cover + ' )'\" :class=\"{'pauseStatus': playStatus, 'loadingStatus': loadingStatus}\"\n                    @click=\"togglePlayFn\" :diasbled=\"!loadingStatus\"></button>\n            <div class=\"info\">\n                <p class=\"tit\">{{musicData.title}}</p>\n                <div class=\"bomStatus\">\n                    <div class=\"progress\" @click=\"clickProgressFn\" ref=\"progerssDom\">\n                        <p class=\"progressBar\" :style=\"{width: progressStr}\"></p>\n                        <button class=\"dot\" :style=\"{left: progressStr}\" @touchmove=\"moveProgressFn\"></button>\n                    </div>\n                </div>\n                <div class=\"time-cover\">\n                    <span class=\"timeStatus\">{{playStatusTime | changeTimeFn}}</span>\n                    <span class=\"timeOver\">{{(duration || musicData.audioDuration) | changeTimeFn}}</span>\n                </div>\n            </div>\n        </div>\n        <audio :src=\"musicData.src\" ref=\"audioDom\" preload=\"auto\" class=\"audio\"></audio>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: '',\n        props: {\n            musicData:{\n                type: Object,\n                required: true,\n                default: {\n                    title: \"起风了\",\n                    cover: \"http://wenba-ooo-qiniu.xueba100.com/cd4ba4a4d6cc0925a9b39d65c3d11ad6.jpeg\",\n                    src: \"http://ting666.yymp3.com:86/new27/mljyyj/1.mp3\",\n                    audioDuration: '',\n                    id: 0\n                }\n            }\n        },\n        data () {\n            return {\n                playStatus: false,\n                progress: 0, // 播放进度 0 － 100\n                duration: 0, // 总时长（秒）\n                durationTime: null, // 总时长（秒）\n                playStatusTime: 0, // 当前播放时间（秒）\n                playEnd: false, // 播放是否结束状态\n                loadingStatus: true\n            }\n        },\n        computed: {\n            progressStr (){\n                return (parseInt(this.progress)) + '%';\n            }\n        },\n        mounted (){\n            this.judegPlayStatusFn();\n            this.getDurationFn();\n            this.observerProgressFn();\n        },\n        methods: {\n            // 重置\n            reset() {\n                this.playStatus = false;\n                this.progress = 0;\n                this.duration = 0;\n                this.playStatusTime = 0;\n                this.loadingStatus = false;\n            },\n            // 播放切换\n            togglePlayFn (){\n                this.playStatus = !this.playStatus;\n                if (this.playStatus) {\n                    // play\n                    this.loadingStatus = true;\n                    if (this.playEnd) {\n                        this.$refs.audioDom.currentTime = 0;\n                        this.observerProgressFn();\n                    }\n                    this.$refs.audioDom.play();\n                } else {\n                    // pause\n                    this.$refs.audioDom.pause();\n                }\n            },\n            // 点击\n            clickProgressFn (event){\n                var offsetX = event.offsetX;\n                var progerssWidth = this.$refs.progerssDom.offsetWidth;\n                this.calculationFn(offsetX, progerssWidth);\n                // 快进\n                if (this.durationTime !== null) {\n                    this.$refs.audioDom.currentTime = offsetX / progerssWidth * this.durationTime;\n                }\n            },\n            // 拖动\n            moveProgressFn (event){\n                var progerssLeft = this.$refs.progerssDom.offsetLeft;\n                var progerssWidth = this.$refs.progerssDom.offsetWidth;\n                var maxClientX = progerssLeft + progerssWidth;\n                var clientX = event.touches[0].clientX;\n                if (event.touches[0].clientX >= maxClientX) {\n                    clientX = maxClientX;\n                }\n                if (event.touches[0].clientX <= progerssLeft) {\n                    clientX = progerssLeft;\n                }\n                var curLen = clientX - progerssLeft;\n                if (clientX > maxClientX) {\n                    return false;\n                }\n                this.calculationFn(curLen, progerssWidth);\n                // 快进\n                if (this.durationTime !== null) {\n                    this.$refs.audioDom.currentTime = curLen / progerssWidth * this.durationTime;\n                }\n            },\n            // 计算进度条\n            calculationFn (curLen, totalLen){\n                // curlen 当前长度；totleLen 总长\n                this.progress = (parseFloat(parseInt(curLen) / parseInt(totalLen))).toFixed(2) * 100;\n                this.progress = this.progress >= 100 ? 100 : this.progress;\n            },\n            // 获取时长\n            getDurationFn (){\n                var _this = this;\n                var audioDom = this.$refs.audioDom;\n                this.timer1 = setInterval(function () {\n                    if (audioDom.readyState != 0) {\n                        _this.loadingStatus = false;\n                        _this.durationTime = audioDom.duration;\n                        _this.duration = audioDom.duration;\n                        clearInterval(_this.timer1);\n                    }\n                }, 200);\n            },\n            // 监控播放进度\n            observerProgressFn (){\n                var _this = this;\n                var musicId = this.musicData.id || 0;\n                var audioDom = this.$refs.audioDom;\n                var audioDuration = null;\n                var isIOS = !!navigator.userAgent.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/);\n                if (isIOS) {\n                    _this.loadingStatus = false;\n                }\n                this.timer2 = setInterval(function () {\n                    if (audioDom.readyState === 4) {\n                        _this.loadingStatus = false;\n                        if (audioDuration === null) {\n                            audioDuration = audioDom.duration;\n                            _this.durationTime = audioDom.duration;\n                            _this.duration = audioDom.duration;\n                        }\n                        _this.playStatusTime = audioDom.currentTime;\n                        _this.progress = parseInt(audioDom.currentTime / audioDuration * 100);\n                        localStorage.setItem('musicId', musicId);\n                        localStorage.setItem('currentTime', audioDom.currentTime);\n                        if (audioDom.ended) {\n                            _this.playStatus = false;\n                            _this.playEnd = true;\n                            _this.playEndFn();\n                            clearInterval(_this.timer2);\n                        }\n                    }\n                }, 1000)\n            },\n            // 监控音频播放结束\n            playEndFn () {\n                this.$emit('playEndFn');\n            },\n            // 判断是否有记忆播放状态\n            judegPlayStatusFn (){\n                if (this.musicData.hasOwnProperty('id') && this.musicData.id !== '' ) {\n                    var musicId = localStorage.getItem('musicId');\n                    var cookieCurrentTime = localStorage.getItem('currentTime');\n                    if (musicId !== null && musicId == this.musicData.id) {\n                        this.$refs.audioDom.currentTime = cookieCurrentTime;\n                    }\n                }\n            }\n        },\n        filters: {\n            // 秒(s) ＝> 00:00\n            changeTimeFn (time){\n                var timeRxFn = function (x) {\n                    var timeRx = new RegExp(/^[0-9]$/g);\n                    if (timeRx.test(x)) {\n                        return '0' + x;\n                    } else {\n                        return x;\n                    }\n                };\n                var _time = time;\n                var hour = parseInt(_time / 3600); //时\n                var minutes = parseInt((_time % 3600) / 60); //分\n                var second = parseInt((_time % 3600) % 60); //秒\n                var timeStr = hour + ':' + timeRxFn(minutes) + ':' + timeRxFn(second);\n                if (hour == 0) {\n                    timeStr = timeRxFn(minutes) + ':' + timeRxFn(second);\n                }\n                return timeStr;\n            }\n        },\n        watch: {\n            'musicData.src': {\n                handler (newVal, oldVal){\n                    this.reset();\n                },\n                deep: true\n            }\n        },\n        destroyed () {\n            clearInterval(this.timer1);\n            clearInterval(this.timer2);\n        }\n    }\n</script>\n<style>\n    .audioPlayerX {\n        display: block;\n        width: 100%;\n        height: 80px;\n        padding: 5px 6px;\n        box-sizing: border-box;\n        position: relative;\n    }\n\n    .audioPlayerX .audioCard {\n        width: 100%;\n        height: 100%;\n    }\n\n    .audioPlayerX .audioCard .playBtn {\n        float: left;\n        width: 50px;\n        height: 50px;\n        margin-top:10px;\n        background-position: center;\n        background-color: #efefef;\n        background-repeat: no-repeat;\n        background-size: cover;\n        position: relative;\n        z-index: 2;\n    }\n\n    .audioPlayerX .audioCard .playBtn::after {\n        content: '';\n        position: absolute;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        background: url(\"./img/playIco.png\") no-repeat 60% center;\n        background-color: rgba(0, 0, 0, 0);\n        background-size: 50% auto;\n    }\n\n    .audioPlayerX .audioCard .playBtn.pauseStatus::after {\n        background-image: url(\"./img/pauseIco.png\");\n        background-position: 56% center;\n        background-size: 50% auto;\n    }\n\n    .audioPlayerX .audioCard .playBtn.loadingStatus::after {\n        background-image: url(\"./img/loding.png\");\n        background-position: center;\n        background-size: 50% auto;\n        animation: rotateFrame 3s infinite linear;\n        -webkit-animation: rotateFrame 3s infinite linear;\n        -moz-animation: rotateFrame 3s infinite linear;\n        -ms-animation: rotateFrame 3s infinite linear;\n        -o-animation: rotateFrame 3s infinite linear;\n    }\n\n    @keyframes rotateFrame {\n        from {\n            transform: rotate(0deg);\n        }\n        to {\n            transform: rotate(360deg);\n        }\n    }\n\n    @-webkit-keyframes rotateFrame {\n        from {\n            transform: rotate(0deg);\n        }\n        to {\n            transform: rotate(360deg);\n        }\n    }\n\n    @-moz-keyframes rotateFrame {\n        from {\n            transform: rotate(0deg);\n        }\n        to {\n            transform: rotate(360deg);\n        }\n    }\n    @-ms-keyframes rotateFrame {\n        from {\n            transform: rotate(0deg);\n        }\n        to {\n            transform: rotate(360deg);\n        }\n    }\n    @-o-keyframes rotateFrame {\n        from {\n            transform: rotate(0deg);\n        }\n        to {\n            transform: rotate(360deg);\n        }\n    }\n\n    .audioPlayerX .audioCard .info {\n        position: absolute;\n        left:0;\n        top:0;\n        width: 100%;\n        padding: 15px 10px 0 70px;\n        box-sizing: border-box;\n    }\n\n    .audioPlayerX .audioCard .info .tit {\n        display: block;\n        font-size: 12px;\n        width: 100%;\n        height: 14px;\n        line-height: 14px;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        color: #979797;\n        white-space: nowrap;\n        padding-bottom: 8px;\n    }\n\n    .audioPlayerX .bomStatus {\n        width: 100%;\n        height: 14px;\n        line-height: 14px;\n    }\n\n    .audioPlayerX .audioCard .info .progress {\n        float: left;\n        width: 95%;\n        height: 2px;\n        background: rgba(237, 237, 237, 0.4);\n        border-radius: 2px;\n        margin-top: 5px;\n        cursor: pointer;\n        position: relative;\n    }\n\n    .audioPlayerX .audioCard .info .progressBar {\n        width: 95%;\n        height: 100%;\n        border-bottom-left-radius: 2px;\n        border-top-left-radius: 2px;\n        background: #FE5263;\n    }\n\n    .audioPlayerX .audioCard .info .progress .dot {\n        position: absolute;\n        top: -6px;\n        width: 14px;\n        height: 14px;\n        border-radius: 50%;\n        background: rgba(254, 70, 86, 0.17);\n    }\n\n    .audioPlayerX .audioCard .info .progress .dot::after {\n        content: '';\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        margin: -3px 0 0 -3px;\n        width: 6px;\n        height: 6px;\n        /*! autoprefixer: off */\n        background: -webkit-linear-gradient(left top, #FF6773, #FE5263);\n        /* autoprefixer: on */\n        background: linear-gradient(left top, #FF6773, #FE5263);\n        border-radius: 50%;\n    }\n\n    .audioPlayerX .time-cover {\n        font-size: 10px;\n        color: #333;\n        overflow: hidden;\n        line-height: 10px;\n        padding-top: 4px;\n        width: 95%;\n    }\n\n    .audioPlayerX .timeStatus {\n        float: left;\n    }\n\n    .audioPlayerX .timeOver {\n        float: right;\n    }\n\n    .audioPlayerX .audio {\n        width: 1px;\n        height: 1px;\n        opacity: 0;\n    }\n</style>"]}]}