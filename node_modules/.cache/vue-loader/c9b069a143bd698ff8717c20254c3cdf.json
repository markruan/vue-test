{"remainingRequest":"/Users/mark/vue/vue-test/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mark/vue/vue-test/src/pages/player.vue?vue&type=style&index=0&id=d7ffdeb4&scoped=true&lang=css&","dependencies":[{"path":"/Users/mark/vue/vue-test/src/pages/player.vue","mtime":1602901367028},{"path":"/Users/mark/vue/vue-test/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/mark/vue/vue-test/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/mark/vue/vue-test/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/mark/vue/vue-test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mark/vue/vue-test/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.v-lyric {\n  text-align: center !important;\n}\n.lyric-active {\n  color: red !important;\n  font-size: 20px;\n}\n.v-image {\n  position: absolute;\n  left: 15%;\n  top: 15%;\n  width: 70%;\n  box-sizing: border-box;\n}\n.border {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n}\n@-webkit-keyframes rotation {\n  from {\n    -webkit-transform: rotate(0deg);\n  }\n  to {\n    -webkit-transform: rotate(360deg);\n  }\n}\n\n.Rotation {\n  -webkit-transform: rotate(360deg);\n  animation: rotation 8s linear infinite;\n  -moz-animation: rotation 8s linear infinite;\n  -webkit-animation: rotation 8s linear infinite;\n  -o-animation: rotation 8s linear infinite;\n}\n.title {\n  padding-top: 12px;\n  text-align: center;\n}\n.myswipe {\n  height: 25rem;\n}\n.audio-player {\n  margin: 0 15px;\n  position: fixed;\n  width: 90%;\n  bottom: 0;\n}\n",{"version":3,"sources":["player.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"player.vue","sourceRoot":"src/pages","sourcesContent":[" \n<template>\n  <div>\n    <van-nav-bar left-text=\"返回\" left-arrow @click-left=\"onClickLeft\" />\n    <div>\n      <van-swipe class=\"my-swipe myswipe\" indicator-color=\"red\" v-if=\"audioSources.pic\">\n        <van-swipe-item>\n          <div class=\"v-image\">\n            <div class=\"border\">\n              <van-image\n                :src=\"audioSources.pic\"\n                round\n                :class=\"{'Rotation':playing}\"\n                style=\"width:100%\"\n              ></van-image>\n            </div>\n            <div class=\"title\">{{audioSources.title+'-'+audioSources.artist}}</div>\n          </div>\n        </van-swipe-item>\n\n        <van-swipe-item v-if=\"lyricShow\" class=\"v-lyric\">\n          <LyricScroll\n            :lyric=\"lyric\"\n            lyricLineheight=\"1.2em\"\n            :current-time=\"currentTime\"\n            :lyricActiveClass=\"active\"\n          />\n        </van-swipe-item>\n      </van-swipe>\n      <audioPlayer class=\"player\" />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapActions } from \"vuex\";\nimport LyricScroll from \"vue-lyric-scroll\";\nimport audioPlayer from \"../components/audio-player\";\n\nexport default {\n  name: \"app\",\n  data() {\n    return {\n      isfull: false,\n      audioSources: {},\n      audioList: [],\n      timeupdate: {},\n      xuzhuan: \"Rotation\",\n      lyric: {},\n      active: \"lyric-active\",\n      lyricShow:false\n    };\n  },\n  components: {\n    LyricScroll,\n    audioPlayer\n  },\n  watch: {\n    '$store.state.currentTime': function (val) {\n      \n      if(val){\n        this.lyricShow = true;\n      }\n    },\n  },\n  methods: {\n    async init() {\n      await this.getMusicInfo();\n      await this.getlyric();\n    },\n    timeStrToNum(str) {\n      const minute = Number(str.slice(0, 2));\n      const second = Number(str.slice(3, 5));\n      const minSec = Number(str.slice(6, 8));\n      return minute * 60 + second + minSec / 100;\n    },\n    // 将歌词字符串转换为对象，格式为{开始时间: 歌词, ...}\n    lyricToObj(lyricStr) {\n      const obj = {};\n      let perLyric;\n      let time;\n      lyricStr.split(\"\\n\").forEach((item, idx) => {\n        perLyric = item.slice(item.indexOf(\"]\") + 1);\n        if (perLyric) {\n          time = this.timeStrToNum(item.slice(1, 9));\n          obj[time] = perLyric;\n        }\n      });\n      return obj;\n    },\n    onClickLeft() {\n      this.$store.commit(\"changeShowPlayer\");\n      this.$router.go(-1); //返回上一层\n    },\n    async getlyric() {\n      const self = this;\n      this.$http\n        .get(this.host + \"/lyric\", { params: { id: this.$route.params.id } })\n        .then(response => {\n          if (response.data.lrc.lyric) {\n            this.lyric = self.lyricToObj(response.data.lrc.lyric);\n          }\n        })\n        .catch(error => {\n          console.log(\"接口或处理逻辑出错\");\n        });\n    },\n    async getMusicInfo() {\n      const this_ = this;\n      this.$http\n        .get(this.host + \"/song/url\", { params: { id: this.$route.params.id } })\n        .then(response => {\n          for (const item of this.playList) {\n            if (item.id == this.$route.params.id) {\n              this.musicInfo = item;\n            }\n          }\n          this.audioSources = {\n            title: this.musicInfo.name,\n            artist: this.musicInfo.ar[0].name,\n            pic: this.musicInfo.al.picUrl + \"?param=500y500\",\n            src: response.data.data[0].url,\n            id: this.$route.params.id\n          };\n          this_.audioList.push(response.data.data[0].url);\n          this_.$store.dispatch(\"setSongInfoActions\", this.audioSources);\n          this_.$store.commit(\"changeShowPlayer\");\n          this_.$store.commit(\"addSongToHistory\", this.audioSources);\n        })\n        .catch(error => {\n          console.log(\"接口或处理逻辑出错\");\n        });\n    }\n  },\n  mounted() {\n    this.init();\n  },\n  computed: {\n    ...mapState([\"playList\", \"playing\", \"currentTime\", \"duration\"])\n  }\n};\n</script>\n <style scoped >\n.v-lyric {\n  text-align: center !important;\n}\n.lyric-active {\n  color: red !important;\n  font-size: 20px;\n}\n.v-image {\n  position: absolute;\n  left: 15%;\n  top: 15%;\n  width: 70%;\n  box-sizing: border-box;\n}\n.border {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n}\n@-webkit-keyframes rotation {\n  from {\n    -webkit-transform: rotate(0deg);\n  }\n  to {\n    -webkit-transform: rotate(360deg);\n  }\n}\n\n.Rotation {\n  -webkit-transform: rotate(360deg);\n  animation: rotation 8s linear infinite;\n  -moz-animation: rotation 8s linear infinite;\n  -webkit-animation: rotation 8s linear infinite;\n  -o-animation: rotation 8s linear infinite;\n}\n.title {\n  padding-top: 12px;\n  text-align: center;\n}\n.myswipe {\n  height: 25rem;\n}\n.audio-player {\n  margin: 0 15px;\n  position: fixed;\n  width: 90%;\n  bottom: 0;\n}\n</style>"]}]}